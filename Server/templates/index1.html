<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PDF Risk Analyzer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg: #0f1724;
      --card: #0f172a;
      --muted: #94a3b8;
      --accent: #38bdf8;
      --glass: rgba(255,255,255,0.03);
      --btn: #10b981;
      --btn-hover: #059669;
      --danger: #ef4444;
      font-family: "Inter", "Segoe UI", Roboto, Arial, sans-serif;
    }
    html,body{height:100%; margin:0; background:linear-gradient(180deg,#071024 0%, #071430 100%); color:#e6eef6;}
    .wrap{max-width:920px; margin:48px auto; padding:28px; background:var(--card); border-radius:14px; box-shadow:0 10px 40px rgba(2,6,23,0.6);}

    header{display:flex; gap:16px; align-items:center; margin-bottom:18px;}
    .logo {
      width:64px; height:64px; border-radius:10px;
      background:linear-gradient(135deg,#06b6d4,#7c3aed); display:flex; align-items:center; justify-content:center;
      font-weight:700; color:white; font-size:20px;
      box-shadow:0 6px 18px rgba(12,22,36,0.6);
    }
    h1{font-size:20px; margin:0; color:var(--accent);}
    p.lead{margin:6px 0 0; color:var(--muted);}

    .grid{display:flex; gap:20px; align-items:flex-start; flex-wrap:wrap; margin-top:20px;}
    .left{
      flex:1 1 420px;
      background:var(--glass); padding:18px; border-radius:12px; border:1px solid rgba(255,255,255,0.03);
    }
    .right{
      width:320px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      padding:18px; border-radius:12px; border:1px solid rgba(255,255,255,0.03);
    }

    .upload-box{
      border:2px dashed rgba(255,255,255,0.06);
      border-radius:10px; padding:28px; text-align:center; cursor:pointer;
      transition:all .18s ease; background:transparent;
    }
    .upload-box:hover{ transform:translateY(-4px); box-shadow:0 10px 30px rgba(2,6,23,0.6); }
    .upload-box input{ display:none; }
    .upload-title{ font-size:16px; color:#dff5ff; margin-bottom:8px; }
    .upload-sub{ color:var(--muted); font-size:13px; margin-bottom:14px; }
    .file-name{ color:#a7f3d0; font-weight:600; margin-top:10px; display:none; }

    .btn{
      display:inline-block; background:var(--btn); color:#04201a; padding:10px 16px; border-radius:10px; font-weight:700; border:none;
      cursor:pointer; margin-top:12px;
    }
    .btn:hover{ background:var(--btn-hover); color:white; }

    .info { color:var(--muted); font-size:13px; line-height:1.65; }
    .techs { margin-top:12px; display:flex; flex-wrap:wrap; gap:8px; }
    .chip { background:rgba(255,255,255,0.03); color:#dbeafe; padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid rgba(255,255,255,0.02); }

    footer{ margin-top:20px; text-align:center; color:var(--muted); font-size:13px; }

    @media (max-width:760px){
      .right{ width:100%; order:2; }
      .left{ order:1; }
      header{ gap:10px; }
      .wrap{ margin:18px; padding:18px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">RA</div>
      <div>
        <h1>PDF Risk Analyzer</h1>
        <p class="lead">Upload your obfuscation / analysis PDF â€” we scan 13 techniques and give a risk score.</p>
      </div>
    </header>

    <div class="grid">
      <div class="left">
        <label class="upload-box" id="uploadBox">
          <div class="upload-title">Click to choose or drop a PDF file</div>
          <div class="upload-sub">Supported: obfuscation reports or analysis PDFs. Max file size: browser limit.</div>
          <input type="file" id="pdfInput" name="pdf" accept=".pdf" />
          <div class="file-name" id="fileName"></div>
        </label>

        <div style="margin-top:12px;">
          <button class="btn" id="analyzeBtn" onclick="submitForm()">Analyze</button>
          <button class="btn" id="clearBtn" style="background:#ef4444; margin-left:8px;" onclick="clearFile()">Clear</button>
        </div>

        <div style="margin-top:18px;" class="info">
          <strong>How it works (short):</strong>
          <div>We parse your PDF, count cases under each technique section, compute a weighted risk score and show a nice dashboard.</div>
        </div>
      </div>

      <div class="right">
        <h3 style="margin:0 0 8px 0; color:var(--accent)">Techniques Checked</h3>
        <div class="techs">
          <span class="chip">String Encryption</span>
          <span class="chip">Identifier Cleaner</span>
          <span class="chip">Control Flow</span>
          <span class="chip">Dead Code</span>
          <span class="chip">Inline Expansion</span>
          <span class="chip">Opaque Predicates</span>
          <span class="chip">Control Flow Flattening</span>
          <span class="chip">Instruction Substitution</span>
          <span class="chip">Dynamic Code Loading</span>
          <span class="chip">Junk Code</span>
          <span class="chip">API Redirection</span>
          <span class="chip">Mixed Language Obfuscation</span>
          <span class="chip">Identifier Obfuscation</span>
        </div>

        <hr style="border:none; height:1px; background:rgba(255,255,255,0.03); margin:16px 0;" />
      </div>
    </div>
  </div>

  <form id="uploadForm" method="post" enctype="multipart/form-data" style="display:none;">
    <input type="file" name="pdf" id="realInput" />
  </form>

  <script>
    const pdfInput = document.getElementById('pdfInput');
    const fileNameEl = document.getElementById('fileName');
    const uploadBox = document.getElementById('uploadBox');

    pdfInput.addEventListener('change', () => {
      const f = pdfInput.files[0];
      if (!f) { fileNameEl.style.display='none'; return; }
      fileNameEl.textContent = 'Selected: ' + f.name;
      fileNameEl.style.display = 'block';
      const real = document.getElementById('realInput');
      real.files = pdfInput.files;
    });

    ['dragenter','dragover'].forEach(ev => {
      uploadBox.addEventListener(ev, e => { e.preventDefault(); uploadBox.style.opacity = 0.95; });
    });
    ['dragleave','drop'].forEach(ev => {
      uploadBox.addEventListener(ev, e => { e.preventDefault(); uploadBox.style.opacity = 1; });
    });
    uploadBox.addEventListener('drop', (e) => {
      e.preventDefault();
      const f = e.dataTransfer.files[0];
      if (!f) return;
      if (!f.name.toLowerCase().endsWith('.pdf')) { alert('Please drop a PDF file'); return; }
      pdfInput.files = e.dataTransfer.files;
      pdfInput.dispatchEvent(new Event('change'));
    });


    function submitForm(){
      const real = document.getElementById('realInput');
      if (!real.files || real.files.length === 0) { alert('Please choose a PDF first'); return; }
      const form = new FormData();
      form.append('pdf', real.files[0]);

      // POST to the mounted obfuscation app
      fetch('/obfuscation/', { method:'POST', body: form })
        .then(r => r.text())
        .then(html => {
          document.open();
          document.write(html);
          document.close();
        })
        .catch(err => { alert('Upload failed'); console.error(err); });
    }

    function clearFile(){
      pdfInput.value = '';
      document.getElementById('realInput').value = '';
      fileNameEl.style.display = 'none';
    }
  </script>
</body>
</html>
